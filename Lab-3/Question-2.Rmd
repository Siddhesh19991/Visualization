---
title: "Untitled"
output: html_document
date: "2024-09-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### Question-2

```{r}
setwd("~/Downloads/M A S T E R S /Sem-3/Part-1/Visualization/labs/lab-3")

data = read.csv("data.csv",header = TRUE)

```

# 1)
```{r}
# 1) 
library(stringr)
library(tidyr)

setwd("~/Downloads/M A S T E R S /Sem-3/Part-1/Visualization/labs/lab-3")

county_map<-jsonlite::read_json("county.json")


data$region<-str_sub(data$region,4,-1)
data$region<-str_sub(data$region,1,-8)


data <- spread(data,"age","X2016")

colnames(data) <- c("region","young","adult","senior")


data$region[4]<- "Gävleborg"
data$region[6]<- "Jämtland"
data$region[7]<- "Jönköping"
data$region[11]<- "Skåne"
data$region[13]<- "Södermanland"
data$region[15]<- "Värmland"
data$region[16]<- "Västerbotten"
data$region[17]<- "Västernorrland"
data$region[18]<- "Västmanland"
data$region[19]<- "VästraGötaland"
data$region[20]<- "Örebro"
data$region[21]<- "Östergötland"

```


# 2)
```{r}
# 2) 
library(plotly)


data %>% plot_ly(y= ~young, type = "box" , name = "young") %>% add_trace(y = ~adult, type ="box", name = "adult") %>% add_trace(y = ~senior, type ="box", name = "senior") %>% layout(yaxis = list(title = 'Income'))

```


From the box plots, we can see that the income of young is way lower than adult and senior while the income of senior can be seen to be little bit higher than adult. This can be because in the young category they dont have much work experience so they start with a lower income and as the gain more experience, they grow and go to the adult category and therefore their income increases and then they slowly reach an saturation point as they go to the senior category where their income doesnt increase as drastically as the change from young to the adult category.  


# 3)
```{r}
# 3) 
library(akima)
attach(data)
s=interp(young,adult,senior, duplicate = "mean")
detach(data)

plot_ly(x=~s$x, y=~s$y, z=~s$z, type="surface")%>% layout(yaxis = list(title = 'Income'))

```


We see a positive correlation, it indicates that senior incomes tend to increase proportionally with adult and young incomes across the counties.

We can see a linear trend to the model so a linear regression would be suitable to model this dependence as it assumes a linear relationship between the independent variables (adult and young) and the dependent variable (senior).

# 4)
```{r}
# 4) 
g=list(fitbounds="locations", visible=FALSE)

plot_geo(data)%>%add_trace(type="choropleth",geojson=county_map, locations=~region,z=~adult, featureidkey="properties.NAME_1")%>%layout(geo=g)

```

An interesting observation that we can see from this plot for adults is that as we move from the north to the south, the income increases. 

```{r}
g=list(fitbounds="locations", visible=FALSE)

plot_geo(data)%>%add_trace(type="choropleth",geojson=county_map, locations=~region,z=~young, featureidkey="properties.NAME_1")%>%layout(geo=g)

```

An interesting observation that we can see from this plot for adults is that as we move from the north to the south, the income increases. But we dont notice such a strong pattern like that for the young category which can be because of they have less work experience to dictate their income. 


# 5)
```{r}
# 5) 
g=list(fitbounds="locations", visible=FALSE)

plot_geo(data)%>%add_trace(type="choropleth",geojson=county_map, locations=~region,z=~young, featureidkey="properties.NAME_1") %>% add_trace(type="scattergeo",lat=~58.4108, lon=~15.6214) %>%layout(geo=g)

```

